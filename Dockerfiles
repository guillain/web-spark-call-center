FROM node:8
EXPOSE 3333

VOLUME ["/app/data"]

# Install basic utilities
RUN apk add -U \
        ca-certificates \
  && rm -rf /var/cache/apk/* \
  && pip install --no-cache-dir \
          setuptools \
          wheel

# This is failing for some odd pip upgrade error commenting out for now
#RUN pip install --upgrade pip

ADD ./web-spark-call-center /app
WORKDIR /app
RUN npm install --save ciscospark

RUN npm install --save browserify
RUN browserify index.js > bundle.js

RUN npm install -g httpster

CMD [ "httpster" ]
